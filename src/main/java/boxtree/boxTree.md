
# Дерево - практика

## Объекты (узлы дерева)

У каждого объекта есть объем и вес. 
Объем - целое, положительное число (может быть 0). 
Вес - положительное действительное число.

### Коробка 
Коробка может хранить другие коробки и бутылки. Коробка может быть пустой.

Объем коробки не должен быть меньше чем объем элементов внутри коробки. 
У коробки есть вес, определяющийся как сумма весов всех элементов внутри коробки + вес самой коробки (вес самой коробки вычисляется по формуле ```6 * k * V ^ (2/3)```, где **V** - объем, **k** - удельный вес поверхности *1 х 1*, он задается как поле объекта). Также коробки могут быть как не собранные, так заклеенные, и открытые. 
Будем считать, что объем коробки не в собранном виде = 0, а вес рассчитывается по той же формуле.

Не собранные коробки не могут содержать внутри себя объекты. Заклеенные содержат объекты, но не позволяют иметь к ним доступ (см. методы).

### Бутылка
Бутылка помимо основных характеристик имеет имя (```String```).

Бутылка имеет 2 значения, определяющие как вычисляется вес: вес самой бутылки (```double >= 0```), заполненность жидкостью в процентах (```0 <= int <= 100```). Удельный вес жидкости (плотность) может определяться через константу.



## Методы (запросы)

### Методы узлов дерева

* Получить вес объекта.
https://refactoring.guru/ru/design-patterns/composite

* Получить объем объекта.

* Создать копию объекта (если это коробка - копировать нужно все внутренние элементы рекурсивно).
https://refactoring.guru/ru/design-patterns/prototype

* ```toString``` возвращающий строковое представление объектов 
(напр. ```Box(Box(Имя_бутылки1, Имя_бутылки2), DisassembledBox, PrivateBox)```)

### Методы коробок

* Получить количество элементов в коробке (не рекурсивно)

* Проверить, коробка заклеена?

* Проверить, коробка собрана?

* Статический метод. Рекурсивно найти бутылки с данным именем (Нельзя заглядывать внутрь заклеенных коробок). Возвращает список ссылок на бутылки.

* Статический метод. Рекурсивно получить количество элементов внутри коробки (нельзя посчитать количество внутри заклеенных коробок). Коробки так-же считаются как 1 элемент. Т.е. кол-во элементов для коробки внутри которой находится 2 бутылки = 3 элемента.

* Статический метод. Рекурсивно найти самый тяжелый объект внутри (открытые и при этом не пустые коробки не считаются, заклеенные коробки считаются как один объект).

### Методы бутылок 

* Получить объем жидкости.

* Получить вес жидкости.

* Получить имя бутылки.



## Методы (мутационные)

### Методы коробок

* Добавить в коробку переданный элемент (ссылку, т.е. не копируя).

* Удалить из коробки переданный элемент (по ссылке), если элемент присутствует.

* Заклеить коробку, если коробка собрана и открыта.

* Расклеить коробку, если коробка заклеена, при этом итоговый вид коробки должен быть собран.

* Разобрать коробку, если коробка собрана (может быть при этом как заклеена, так и открыта) и не содержит внутри себя элементы.

* Собрать коробку, если коробка разобрана, при этом итоговый вариант коробки должен быть открыт (не заклеен).

* Статический метод. Рекурсивно (без заклеенных коробок) разобрать все собранные коробки, в которых нет других элементов.

* Статический метод. Рекурсивно (без заклеенных коробок) собрать все разобранные коробки (если объем коробки в собранном виде не превышает возможный объем). Например если в коробке с объемом 5 есть 2 коробки с объемами 3 и 3 в собранном виде - то достаточно распаковать любую из них.

* Статический метод. Рекурсивно (без заклеенных коробок) изъять из коробки все, подходящие под данное имя, бутылки. Возвращает список изъятых бутылок.

* Статический метод. Рекурсивно расклеить все коробки.

### Методы бутылок

* Изменить имя бутылки.

* Вылить всю жидкость из бутылки.



## Функции в статических классах
Статический класс - класс с приватным конструктором, без внутреннего состояния, у которого все методы статические. Такие классы применяются для определения функций, констант, фабричных методов (создающих объекты) и тд. В данном случае методы статических классов будут принимать узлы и выполнять определенные специфические процедуры.

### BoxUtils

* Создать одну коробку, в которую переместятся все бутылки из переданной иерархии объектов.

* Копирует переданную иерархию объектов, но без бутылок, имя которых не равно переданному параметру.

* Принимает две иерархии объектов и возвращает объединенную, новую иерархию, по следующим правилам: Для бутылок создается копия бутылок и кладется в текущую созданную коробку. Для коробок по одним индексам - создается новая коробка с объемом равным сумме коробок и весом как сумма весов.  Далее эти же правила применяются для всех внутренних элементов.
Например: ```box1(box2(b1, b2), b3) + box3(box4(box5(), b4)) = box6(box7(box5'(), b1', b2', b4'), b3')```. 
Штрих(```'```) обозначает копию, ```box6``` создается на основе ```box1``` и ```box3``` (сумма объемов и веса), и то же самое для ```box7``` в отношении ```box2``` и ```box4```.

### BoxConstants

* Стандартный коэффициент веса коробки 

* **НЕИЗМЕНЯЕМАЯ** Коробка размером *1000 х 1000*

### BottleConstants

* Стандартная плотность жидкости



## Фабрика
Фабрика - объект, позволяющий создавать определенные сущности, вызывая методы данной фабрики.
https://refactoring.guru/ru/design-patterns/factory-method
https://refactoring.guru/ru/design-patterns/abstract-factory

### Абстрактная фабрика
Базовый тип для фабрик (бутылок и коробок)

* Создать узел переданного объема (метод абстрактный и переопределяется в классах наследниках)

### BoxFactory

* Создать коробку по переданному объему (весовой коэф. определяется через константы)

* Создать случайную иерархию коробок (без бутылок) по переданной максимальной вложенности

### BottleFactory

* Создать бутылку переданного объема



## Дополнительные задания (необязательные)

* Добавить статический метод коробки для рекурсивного получения бутылок по предикату (так же как и поиск по имени, но вместо ```String``` - предикат проверяющий бутылку). 

* Метод коробки для добавления элемента так же принимает ```boolean``` параметр, определяющий нужно ли копировать объект или передавать по ссылке, как в начальном варианте метода.

* Статический метод коробки для сборки разобранных коробок пытается собрать как можно больше не собранных коробок. Например если в коробке с объемом 5 есть 4 коробки с объемами 1, 3, 2, 1 в собранном виде - то нужно распаковать 1, 1 и 2.

* Статический метод коробки для расклеивания коробок принимает целочисленный параметр - максимум коробок, которые нужно расклеить. Коробки выбираются любым способом. Передав ```MAX_INT``` - расклеиваются все коробки (как в стандартом варианте методов).

* Добавить класс жидкости с разными плотностями и теперь бутылка может хранить не константную жидкость, а смесь из нескольких жидкостей. Так же к бутылке изменяется мутационный метод для добавления жидкости в бутылку (если объем позволяет) и метод для получения жидкостей из бутылки.

* Добавить штрих-код для всех узлов. Штрих-коды могут быть разных типов (например QR-код и обычный). Тип штрих-кода определяется дженерик параметром. В одной иерархии (вложенностей коробок и бутылок) все узлы имеют одинаковый тип штрих-кодов. Так-же добавить соответственный метод для получения штрих-кода из узла, а так же поиск по иерархии по конкретному штрих-коду (возвращает узел). Объект по умолчанию не имеет штрих-кода.